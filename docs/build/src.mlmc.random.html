
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>src.mlmc.random package &#8212; MLMC daf documentation</title>
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="src.mlmc.sim package" href="src.mlmc.sim.html" />
    <link rel="prev" title="src.mlmc.plot package" href="src.mlmc.plot.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="src-mlmc-random-package">
<h1>src.mlmc.random package<a class="headerlink" href="#src-mlmc-random-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-src.mlmc.random.correlated_field">
<span id="src-mlmc-random-correlated-field-module"></span><h2>src.mlmc.random.correlated_field module<a class="headerlink" href="#module-src.mlmc.random.correlated_field" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="src.mlmc.random.correlated_field.Field">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">src.mlmc.random.correlated_field.</span></code><code class="sig-name descname"><span class="pre">Field</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">field</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param_fields</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">regions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/mlmc/random/correlated_field.html#Field"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.mlmc.random.correlated_field.Field" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt id="src.mlmc.random.correlated_field.Field.sample">
<code class="sig-name descname"><span class="pre">sample</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/mlmc/random/correlated_field.html#Field.sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.mlmc.random.correlated_field.Field.sample" title="Permalink to this definition">¶</a></dt>
<dd><p>Internal method to generate/compute new sample.
:return:</p>
</dd></dl>

<dl class="py method">
<dt id="src.mlmc.random.correlated_field.Field.set_points">
<code class="sig-name descname"><span class="pre">set_points</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">points</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/mlmc/random/correlated_field.html#Field.set_points"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.mlmc.random.correlated_field.Field.set_points" title="Permalink to this definition">¶</a></dt>
<dd><p>Internal method to set evaluation points. See Fields.set_points.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="src.mlmc.random.correlated_field.Fields">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">src.mlmc.random.correlated_field.</span></code><code class="sig-name descname"><span class="pre">Fields</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fields</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/mlmc/random/correlated_field.html#Fields"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.mlmc.random.correlated_field.Fields" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt id="src.mlmc.random.correlated_field.Fields.names">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">names</span></code><a class="headerlink" href="#src.mlmc.random.correlated_field.Fields.names" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="src.mlmc.random.correlated_field.Fields.sample">
<code class="sig-name descname"><span class="pre">sample</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/mlmc/random/correlated_field.html#Fields.sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.mlmc.random.correlated_field.Fields.sample" title="Permalink to this definition">¶</a></dt>
<dd><p>Return dictionary of sampled fields.
:return: { ‘field_name’: sample, …}</p>
</dd></dl>

<dl class="py method">
<dt id="src.mlmc.random.correlated_field.Fields.set_outer_fields">
<code class="sig-name descname"><span class="pre">set_outer_fields</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">outer</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/mlmc/random/correlated_field.html#Fields.set_outer_fields"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.mlmc.random.correlated_field.Fields.set_outer_fields" title="Permalink to this definition">¶</a></dt>
<dd><p>Set fields that will be in a dictionary produced by FieldSet.sample() call.
:param outer: A list of names of fields that are sampled.
:return:</p>
</dd></dl>

<dl class="py method">
<dt id="src.mlmc.random.correlated_field.Fields.set_points">
<code class="sig-name descname"><span class="pre">set_points</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">points</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">region_ids</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">region_map</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/mlmc/random/correlated_field.html#Fields.set_points"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.mlmc.random.correlated_field.Fields.set_points" title="Permalink to this definition">¶</a></dt>
<dd><p>Set mesh related data to fields.
- set points for sample evaluation
- translate region names to region ids in fields
- create maps from region constraned point sets of fields to full point set
:param points: np array of points for field evaluation
:param regions: regions of the points;</p>
<blockquote>
<div><p>empty means no points for fields restricted to regions and all points for unrestricted fields</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="src.mlmc.random.correlated_field.FourierSpatialCorrelatedField">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">src.mlmc.random.correlated_field.</span></code><code class="sig-name descname"><span class="pre">FourierSpatialCorrelatedField</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">corr_exp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gauss'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">corr_length</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aniso_correlation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/mlmc/random/correlated_field.html#FourierSpatialCorrelatedField"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.mlmc.random.correlated_field.FourierSpatialCorrelatedField" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#src.mlmc.random.correlated_field.RandomFieldBase" title="src.mlmc.random.correlated_field.RandomFieldBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">src.mlmc.random.correlated_field.RandomFieldBase</span></code></a></p>
<p>Generate spatial random fields</p>
<dl class="py method">
<dt id="src.mlmc.random.correlated_field.FourierSpatialCorrelatedField.exp">
<code class="sig-name descname"><span class="pre">exp</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mode_no</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/mlmc/random/correlated_field.html#FourierSpatialCorrelatedField.exp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.mlmc.random.correlated_field.FourierSpatialCorrelatedField.exp" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute an exponential spectrum
:param mode_no: int, Number of Fourier modes
:return: numpy.ndarray</p>
</dd></dl>

<dl class="py method">
<dt id="src.mlmc.random.correlated_field.FourierSpatialCorrelatedField.gau">
<code class="sig-name descname"><span class="pre">gau</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mode_no</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/mlmc/random/correlated_field.html#FourierSpatialCorrelatedField.gau"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.mlmc.random.correlated_field.FourierSpatialCorrelatedField.gau" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute a gaussian spectrum
:param mode_no: int, Number of Fourier modes
:return: numpy.ndarray</p>
</dd></dl>

<dl class="py method">
<dt id="src.mlmc.random.correlated_field.FourierSpatialCorrelatedField.get_normal_distr">
<code class="sig-name descname"><span class="pre">get_normal_distr</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/mlmc/random/correlated_field.html#FourierSpatialCorrelatedField.get_normal_distr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.mlmc.random.correlated_field.FourierSpatialCorrelatedField.get_normal_distr" title="Permalink to this definition">¶</a></dt>
<dd><p>Normal distributed arrays
:return: np.ndarray</p>
</dd></dl>

<dl class="py method">
<dt id="src.mlmc.random.correlated_field.FourierSpatialCorrelatedField.random_field">
<code class="sig-name descname"><span class="pre">random_field</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/mlmc/random/correlated_field.html#FourierSpatialCorrelatedField.random_field"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.mlmc.random.correlated_field.FourierSpatialCorrelatedField.random_field" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the random modes for the randomization method.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="src.mlmc.random.correlated_field.GSToolsSpatialCorrelatedField">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">src.mlmc.random.correlated_field.</span></code><code class="sig-name descname"><span class="pre">GSToolsSpatialCorrelatedField</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode_no</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/mlmc/random/correlated_field.html#GSToolsSpatialCorrelatedField"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.mlmc.random.correlated_field.GSToolsSpatialCorrelatedField" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#src.mlmc.random.correlated_field.RandomFieldBase" title="src.mlmc.random.correlated_field.RandomFieldBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">src.mlmc.random.correlated_field.RandomFieldBase</span></code></a></p>
<dl class="py method">
<dt id="src.mlmc.random.correlated_field.GSToolsSpatialCorrelatedField.change_srf">
<code class="sig-name descname"><span class="pre">change_srf</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seed</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/mlmc/random/correlated_field.html#GSToolsSpatialCorrelatedField.change_srf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.mlmc.random.correlated_field.GSToolsSpatialCorrelatedField.change_srf" title="Permalink to this definition">¶</a></dt>
<dd><p>Spatial random field with new seed
:param seed: int, random number generator seed
:return: None</p>
</dd></dl>

<dl class="py method">
<dt id="src.mlmc.random.correlated_field.GSToolsSpatialCorrelatedField.random_field">
<code class="sig-name descname"><span class="pre">random_field</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/mlmc/random/correlated_field.html#GSToolsSpatialCorrelatedField.random_field"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.mlmc.random.correlated_field.GSToolsSpatialCorrelatedField.random_field" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate the spatial random field
:return: field, np.ndarray</p>
</dd></dl>

<dl class="py method">
<dt id="src.mlmc.random.correlated_field.GSToolsSpatialCorrelatedField.sample">
<code class="sig-name descname"><span class="pre">sample</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/mlmc/random/correlated_field.html#GSToolsSpatialCorrelatedField.sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.mlmc.random.correlated_field.GSToolsSpatialCorrelatedField.sample" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Random field evaluated in points given by ‘set_points’</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="src.mlmc.random.correlated_field.RandomFieldBase">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">src.mlmc.random.correlated_field.</span></code><code class="sig-name descname"><span class="pre">RandomFieldBase</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">corr_exp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gauss'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">corr_length</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aniso_correlation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/mlmc/random/correlated_field.html#RandomFieldBase"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.mlmc.random.correlated_field.RandomFieldBase" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Base class for various methods for generating random fields.</p>
<p>Generating realizations of a spatially correlated random field F for a fixed set of points at X.
E[F(x)]       = mu(x)
Cov_ij = Cov[x_i,x_j]  = E[(F(x_i) - mu(x))(F(x_j) - mu(x))]</p>
<dl class="simple">
<dt>We assume stationary random field with covariance matrix Cov_ij:</dt><dd><p>Cov_i,j = c(x_i - x_j)</p>
</dd>
<dt>where c(X) is the “stationary covariance” function. We assume:</dt><dd><p>c(X) = sigma^2 exp( -<a href="#id1"><span class="problematic" id="id2">|</span></a>X^t K X|^(alpha/2) )</p>
</dd>
</dl>
<p>for spatially heterogeneous sigma(X) we consider particular non-stationary generalization:          Cov_i,i = sigma(x_i)*sigma(x_j) exp( -<a href="#id3"><span class="problematic" id="id4">|</span></a>X^t K X|^(alpha/2) ); X = x_i - x_j</p>
<dl class="simple">
<dt>where:</dt><dd><ul class="simple">
<li><p>sigma(X) is the standard deviance of the single uncorrelated value</p></li>
<li><p>K is a positive definite tensor with eigen vectors corresponding to
main directions and eigen values equal to (1/l_i)^2, where l_i is correlation
length in singel main direction.</p></li>
<li><p>alpha is =1 for “exponential” and =2 for “Gauss” correlation</p></li>
</ul>
</dd>
<dt>SVD decomposition:</dt><dd><p>Considering first m vectors, such that lam(m)/lam(0) &lt;0.1</p>
</dd>
</dl>
<p>Example:
<a href="#id5"><span class="problematic" id="id6">``</span></a><a href="#id7"><span class="problematic" id="id8">`</span></a></p>
<blockquote>
<div><p>field = SpatialCorrelatedField(corr_exp=’exp’, corr_length=1.5)
X, Y = np.mgrid[0:1:10j, 0:1:10j]
points = np.vstack([X.ravel(), Y.ravel()])
field.set_points(points)
sample = field.sample()</p>
</div></blockquote>
<p><a href="#id9"><span class="problematic" id="id10">``</span></a><a href="#id11"><span class="problematic" id="id12">`</span></a></p>
<dl class="py method">
<dt id="src.mlmc.random.correlated_field.RandomFieldBase.sample">
<code class="sig-name descname"><span class="pre">sample</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/mlmc/random/correlated_field.html#RandomFieldBase.sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.mlmc.random.correlated_field.RandomFieldBase.sample" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>uncorelated</strong> – Random samples from standard normal distribution.
Removed as the spectral method do not support it.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Random field evaluated in points given by ‘set_points’.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="src.mlmc.random.correlated_field.RandomFieldBase.set_points">
<code class="sig-name descname"><span class="pre">set_points</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">points</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/mlmc/random/correlated_field.html#RandomFieldBase.set_points"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.mlmc.random.correlated_field.RandomFieldBase.set_points" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>points</strong> – N x d array. Points X_i where the field will be evaluated. d is the dimension.</p></li>
<li><p><strong>mu</strong> – Scalar or N array. Mean value of uncorrelated field: E( F(X_i)).</p></li>
<li><p><strong>sigma</strong> – Scalar or N array. Standard deviance of uncorrelated field: sqrt( E ( F(X_i) - mu_i )^2 )</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="src.mlmc.random.correlated_field.SpatialCorrelatedField">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">src.mlmc.random.correlated_field.</span></code><code class="sig-name descname"><span class="pre">SpatialCorrelatedField</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">corr_exp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gauss'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">corr_length</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aniso_correlation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/mlmc/random/correlated_field.html#SpatialCorrelatedField"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.mlmc.random.correlated_field.SpatialCorrelatedField" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#src.mlmc.random.correlated_field.RandomFieldBase" title="src.mlmc.random.correlated_field.RandomFieldBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">src.mlmc.random.correlated_field.RandomFieldBase</span></code></a></p>
<dl class="py method">
<dt id="src.mlmc.random.correlated_field.SpatialCorrelatedField.cov_matrix">
<code class="sig-name descname"><span class="pre">cov_matrix</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/mlmc/random/correlated_field.html#SpatialCorrelatedField.cov_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.mlmc.random.correlated_field.SpatialCorrelatedField.cov_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Setup dense covariance matrix for given set of points.
:return: None.</p>
</dd></dl>

<dl class="py method">
<dt id="src.mlmc.random.correlated_field.SpatialCorrelatedField.svd_dcmp">
<code class="sig-name descname"><span class="pre">svd_dcmp</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">precision</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_terms_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(1,</span> <span class="pre">inf)</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/mlmc/random/correlated_field.html#SpatialCorrelatedField.svd_dcmp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.mlmc.random.correlated_field.SpatialCorrelatedField.svd_dcmp" title="Permalink to this definition">¶</a></dt>
<dd><p>Does decomposition of covariance matrix defined by set of points
:param precision: Desired accuracy of the KL approximation, smaller eigen values are dropped.
:param n_terms_range: (min, max) number of terms in KL expansion to use. The number of terms estimated from
given precision is snapped to the given interval.</p>
<dl class="simple">
<dt>truncated SVD:</dt><dd><p>cov_mat = U*diag(ev) * V,
_cov_l_factor = U[:,0:m]*sqrt(ev[0:m])</p>
</dd>
</dl>
<p>Note on number of terms:
According to: C. Schwab and R. A. Todor: KL Approximation of Random Fields by Generalized Fast Multiploe Method
the eigen values should decay as (Proposition 2.18):</p>
<blockquote>
<div><p>lambda_m ~ sigma^2 * ( 1/gamma ) <a href="#id13"><span class="problematic" id="id14">**</span></a>( m**(1/d) + alpha ) / Gamma(0.5 * m**(1/d) )</p>
</div></blockquote>
<p>where gamma = correlation length / domain diameter
ans alpha is the correlation exponent. Gamma is the gamma function.
… should be checked experimantaly and generalized for sigma(X)</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="src.mlmc.random.correlated_field.kozeny_carman">
<code class="sig-prename descclassname"><span class="pre">src.mlmc.random.correlated_field.</span></code><code class="sig-name descname"><span class="pre">kozeny_carman</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">porosity</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">factor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">viscosity</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/mlmc/random/correlated_field.html#kozeny_carman"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.mlmc.random.correlated_field.kozeny_carman" title="Permalink to this definition">¶</a></dt>
<dd><p>Kozeny-Carman law. Empirical relationship between porosity and conductivity.
:param porosity: Porosity value.
:param m: Power. Suitable values are 1 &lt; m &lt; 4
:param factor: [m^2]</p>
<blockquote>
<div><dl class="simple">
<dt>E.g. 1e-7 ,   m = 3.48;  juta fibers</dt><dd><p>2.2e-8 ,     1.46;  glass fibers
1.8e-13,     2.89;  erruptive material
1e-12        2.76;  erruptive material
1.8e-12      1.99;  basalt</p>
</dd>
</dl>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>viscosity</strong> – [Pa . s], water: 8.90e-4</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="src.mlmc.random.correlated_field.positive_to_range">
<code class="sig-prename descclassname"><span class="pre">src.mlmc.random.correlated_field.</span></code><code class="sig-name descname"><span class="pre">positive_to_range</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">exp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/mlmc/random/correlated_field.html#positive_to_range"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.mlmc.random.correlated_field.positive_to_range" title="Permalink to this definition">¶</a></dt>
<dd><p>Mapping a positive parameter ‘exp’ from the interval &lt;0, infty) to the interval &lt;a,b).
Suitable e.g. to generate meaningful porosity from a variable with lognormal distribution.
:param exp: A positive parameter. (LogNormal distribution.)
:param a, b: Range interval.</p>
</dd></dl>

</div>
<div class="section" id="src-mlmc-random-frac-geom-module">
<h2>src.mlmc.random.frac_geom module<a class="headerlink" href="#src-mlmc-random-frac-geom-module" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-src.mlmc.random.gstools_wrapper">
<span id="src-mlmc-random-gstools-wrapper-module"></span><h2>src.mlmc.random.gstools_wrapper module<a class="headerlink" href="#module-src.mlmc.random.gstools_wrapper" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-src.mlmc.random">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-src.mlmc.random" title="Permalink to this headline">¶</a></h2>
</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">MLMC</a></h1>








<h3>Navigation</h3>
<p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="src.mlmc.quantity.html">src.mlmc.quantity package</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="src.mlmc.html">src.mlmc package</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="src.mlmc.html#subpackages">Subpackages</a></li>
<li class="toctree-l2"><a class="reference internal" href="src.mlmc.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="src.mlmc.html#module-src.mlmc.estimator">src.mlmc.estimator module</a></li>
<li class="toctree-l2"><a class="reference internal" href="src.mlmc.html#module-src.mlmc.level_simulation">src.mlmc.level_simulation module</a></li>
<li class="toctree-l2"><a class="reference internal" href="src.mlmc.html#module-src.mlmc.moments">src.mlmc.moments module</a></li>
<li class="toctree-l2"><a class="reference internal" href="src.mlmc.html#module-src.mlmc.sample_storage">src.mlmc.sample_storage module</a></li>
<li class="toctree-l2"><a class="reference internal" href="src.mlmc.html#module-src.mlmc.sample_storage_hdf">src.mlmc.sample_storage_hdf module</a></li>
<li class="toctree-l2"><a class="reference internal" href="src.mlmc.html#module-src.mlmc.sampler">src.mlmc.sampler module</a></li>
<li class="toctree-l2"><a class="reference internal" href="src.mlmc.html#module-src.mlmc.sampling_pool">src.mlmc.sampling_pool module</a></li>
<li class="toctree-l2"><a class="reference internal" href="src.mlmc.html#module-src.mlmc.sampling_pool_pbs">src.mlmc.sampling_pool_pbs module</a></li>
<li class="toctree-l2"><a class="reference internal" href="src.mlmc.html#module-src.mlmc">Module contents</a></li>
</ul>
</li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
  <li><a href="src.mlmc.html">src.mlmc package</a><ul>
      <li>Previous: <a href="src.mlmc.plot.html" title="previous chapter">src.mlmc.plot package</a></li>
      <li>Next: <a href="src.mlmc.sim.html" title="next chapter">src.mlmc.sim package</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2021, Jan Brezina, Martin Spetlik.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 3.5.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/src.mlmc.random.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>