

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>mlmc.random &mdash; mlmc 1.0.1 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="mlmc.sim" href="mlmc.sim.html" />
    <link rel="prev" title="mlmc.quantity" href="mlmc.quantity.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="contents.html" class="icon icon-home"> mlmc
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="index.html">MLMC</a><ul>
<li class="toctree-l2"><a class="reference internal" href="index.html#installation">Installation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Tutorials</a><ul>
<li class="toctree-l2"><a class="reference internal" href="examples_sampler_creation.html">Sampler creation</a></li>
<li class="toctree-l2"><a class="reference internal" href="examples_samples_scheduling.html">Samples scheduling</a><ul>
<li class="toctree-l3"><a class="reference internal" href="examples_samples_scheduling.html#prescribe-the-exact-number-of-samples">1. Prescribe the exact number of samples</a></li>
<li class="toctree-l3"><a class="reference internal" href="examples_samples_scheduling.html#prescribe-a-target-variance">2. Prescribe a target variance</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="examples_quantity.html">Quantity tutorial</a><ul>
<li class="toctree-l3"><a class="reference internal" href="examples_quantity.html#mean-estimates">Mean estimates</a></li>
<li class="toctree-l3"><a class="reference internal" href="examples_quantity.html#estimate-moments-and-covariance-matrix">Estimate moments and covariance matrix</a></li>
<li class="toctree-l3"><a class="reference internal" href="examples_quantity.html#quantity-selection">Quantity selection</a></li>
<li class="toctree-l3"><a class="reference internal" href="examples_quantity.html#binary-operations">Binary operations</a></li>
<li class="toctree-l3"><a class="reference internal" href="examples_quantity.html#numpy-universal-functions">NumPy universal functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="examples_quantity.html#quantity-selection-by-conditions">Quantity selection by conditions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="examples_postprocessing.html">Results postprocessing</a><ul>
<li class="toctree-l3"><a class="reference internal" href="examples_postprocessing.html#probability-density-function-approximation">Probability density function approximation</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="mlmc.html">MLMC package</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="mlmc.html#subpackages">Subpackages</a></li>
<li class="toctree-l2"><a class="reference internal" href="mlmc.html#classes">Classes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="mlmc.html#sampler">Sampler</a></li>
<li class="toctree-l3"><a class="reference internal" href="mlmc.html#samplingpool">SamplingPool</a></li>
<li class="toctree-l3"><a class="reference internal" href="mlmc.html#samplingpoolpbs">SamplingPoolPBS</a></li>
<li class="toctree-l3"><a class="reference internal" href="mlmc.html#samplestorage">SampleStorage</a></li>
<li class="toctree-l3"><a class="reference internal" href="mlmc.html#samplestoragehdf">SampleStorageHDF</a></li>
<li class="toctree-l3"><a class="reference internal" href="mlmc.html#estimate">Estimate</a></li>
<li class="toctree-l3"><a class="reference internal" href="mlmc.html#moments">Moments</a></li>
<li class="toctree-l3"><a class="reference internal" href="mlmc.html#levelsimulation">LevelSimulation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="mlmc.plot.html">mlmc.plot</a><ul>
<li class="toctree-l3"><a class="reference internal" href="mlmc.plot.html#submodules">Submodules</a></li>
<li class="toctree-l3"><a class="reference internal" href="mlmc.plot.html#module-mlmc.plot.plots">mlmc.plot.plots module</a></li>
<li class="toctree-l3"><a class="reference internal" href="mlmc.plot.html#module-mlmc.plot.violinplot">mlmc.plot.violinplot module</a></li>
<li class="toctree-l3"><a class="reference internal" href="mlmc.plot.html#module-0">Module contents</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="mlmc.quantity.html">mlmc.quantity</a><ul>
<li class="toctree-l3"><a class="reference internal" href="mlmc.quantity.html#submodules">Submodules</a></li>
<li class="toctree-l3"><a class="reference internal" href="mlmc.quantity.html#module-mlmc.quantity.quantity">mlmc.quantity.quantity module</a></li>
<li class="toctree-l3"><a class="reference internal" href="mlmc.quantity.html#module-mlmc.quantity.quantity_estimate">mlmc.quantity.quantity_estimate module</a></li>
<li class="toctree-l3"><a class="reference internal" href="mlmc.quantity.html#module-mlmc.quantity.quantity_spec">mlmc.quantity.quantity_spec module</a></li>
<li class="toctree-l3"><a class="reference internal" href="mlmc.quantity.html#module-mlmc.quantity.quantity_types">mlmc.quantity.quantity_types module</a></li>
<li class="toctree-l3"><a class="reference internal" href="mlmc.quantity.html#module-0">Module contents</a></li>
</ul>
</li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">mlmc.random</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#submodules">Submodules</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-mlmc.random.correlated_field">mlmc.random.correlated_field module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#mlmc-random-frac-geom-module">mlmc.random.frac_geom module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#mlmc-random-gstools-wrapper-module">mlmc.random.gstools_wrapper module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-0">Module contents</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="mlmc.sim.html">mlmc.sim</a><ul>
<li class="toctree-l3"><a class="reference internal" href="mlmc.sim.html#submodules">Submodules</a></li>
<li class="toctree-l3"><a class="reference internal" href="mlmc.sim.html#module-mlmc.sim.simulation">mlmc.sim.simulation module</a></li>
<li class="toctree-l3"><a class="reference internal" href="mlmc.sim.html#module-mlmc.sim.synth_simulation">mlmc.sim.synth_simulation module</a></li>
<li class="toctree-l3"><a class="reference internal" href="mlmc.sim.html#module-0">Module contents</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="mlmc.tool.html">mlmc.tool</a><ul>
<li class="toctree-l3"><a class="reference internal" href="mlmc.tool.html#submodules">Submodules</a></li>
<li class="toctree-l3"><a class="reference internal" href="mlmc.tool.html#mlmc-tool-context-statprof-module">mlmc.tool.context_statprof module</a></li>
<li class="toctree-l3"><a class="reference internal" href="mlmc.tool.html#module-mlmc.tool.distribution">mlmc.tool.distribution module</a></li>
<li class="toctree-l3"><a class="reference internal" href="mlmc.tool.html#module-mlmc.tool.flow_mc">mlmc.tool.flow_mc module</a></li>
<li class="toctree-l3"><a class="reference internal" href="mlmc.tool.html#module-mlmc.tool.gmsh_io">mlmc.tool.gmsh_io module</a></li>
<li class="toctree-l3"><a class="reference internal" href="mlmc.tool.html#module-mlmc.tool.hdf5">mlmc.tool.hdf5 module</a></li>
<li class="toctree-l3"><a class="reference internal" href="mlmc.tool.html#module-mlmc.tool.pbs_job">mlmc.tool.pbs_job module</a></li>
<li class="toctree-l3"><a class="reference internal" href="mlmc.tool.html#module-mlmc.tool.process_base">mlmc.tool.process_base module</a></li>
<li class="toctree-l3"><a class="reference internal" href="mlmc.tool.html#module-mlmc.tool.simple_distribution">mlmc.tool.simple_distribution module</a></li>
<li class="toctree-l3"><a class="reference internal" href="mlmc.tool.html#module-mlmc.tool.stats_tests">mlmc.tool.stats_tests module</a></li>
<li class="toctree-l3"><a class="reference internal" href="mlmc.tool.html#module-0">Module contents</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="contents.html">mlmc</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="contents.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="mlmc.html">MLMC package</a> &raquo;</li>
        
      <li>mlmc.random</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/mlmc.random.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <div class="rst-breadcrumbs-buttons" role="navigation" aria-label="breadcrumb navigation">
      
        <a href="mlmc.sim.html" class="btn btn-neutral float-right" title="mlmc.sim" accesskey="n">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
      
      
        <a href="mlmc.quantity.html" class="btn btn-neutral float-left" title="mlmc.quantity" accesskey="p"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
      
  </div>
  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-mlmc.random">
<span id="mlmc-random"></span><h1>mlmc.random<a class="headerlink" href="#module-mlmc.random" title="Permalink to this headline">¶</a></h1>
<p>Subpackage provides random field generation and <a class="reference external" href="https://geostat-framework.readthedocs.io/projects/gstools/en/stable/index.html">GSTools library</a> interface</p>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-mlmc.random.correlated_field">
<span id="mlmc-random-correlated-field-module"></span><h2>mlmc.random.correlated_field module<a class="headerlink" href="#module-mlmc.random.correlated_field" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="mlmc.random.correlated_field.Field">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">mlmc.random.correlated_field.</span></code><code class="sig-name descname"><span class="pre">Field</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">field</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param_fields</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">regions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mlmc/random/correlated_field.html#Field"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mlmc.random.correlated_field.Field" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt id="mlmc.random.correlated_field.Field.sample">
<code class="sig-name descname"><span class="pre">sample</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mlmc/random/correlated_field.html#Field.sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mlmc.random.correlated_field.Field.sample" title="Permalink to this definition">¶</a></dt>
<dd><p>Internal method to generate/compute new sample.
:return:</p>
</dd></dl>

<dl class="py method">
<dt id="mlmc.random.correlated_field.Field.set_points">
<code class="sig-name descname"><span class="pre">set_points</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">points</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mlmc/random/correlated_field.html#Field.set_points"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mlmc.random.correlated_field.Field.set_points" title="Permalink to this definition">¶</a></dt>
<dd><p>Internal method to set evaluation points. See Fields.set_points.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="mlmc.random.correlated_field.Fields">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">mlmc.random.correlated_field.</span></code><code class="sig-name descname"><span class="pre">Fields</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fields</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mlmc/random/correlated_field.html#Fields"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mlmc.random.correlated_field.Fields" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt id="mlmc.random.correlated_field.Fields.sample">
<code class="sig-name descname"><span class="pre">sample</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mlmc/random/correlated_field.html#Fields.sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mlmc.random.correlated_field.Fields.sample" title="Permalink to this definition">¶</a></dt>
<dd><p>Return dictionary of sampled fields.
:return: { ‘field_name’: sample, …}</p>
</dd></dl>

<dl class="py method">
<dt id="mlmc.random.correlated_field.Fields.set_outer_fields">
<code class="sig-name descname"><span class="pre">set_outer_fields</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">outer</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mlmc/random/correlated_field.html#Fields.set_outer_fields"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mlmc.random.correlated_field.Fields.set_outer_fields" title="Permalink to this definition">¶</a></dt>
<dd><p>Set fields that will be in a dictionary produced by FieldSet.sample() call.
:param outer: A list of names of fields that are sampled.
:return:</p>
</dd></dl>

<dl class="py method">
<dt id="mlmc.random.correlated_field.Fields.set_points">
<code class="sig-name descname"><span class="pre">set_points</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">points</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">region_ids</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">region_map</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mlmc/random/correlated_field.html#Fields.set_points"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mlmc.random.correlated_field.Fields.set_points" title="Permalink to this definition">¶</a></dt>
<dd><p>Set mesh related data to fields.
- set points for sample evaluation
- translate region names to region ids in fields
- create maps from region constraned point sets of fields to full point set
:param points: np array of points for field evaluation
:param regions: regions of the points;</p>
<blockquote>
<div><p>empty means no points for fields restricted to regions and all points for unrestricted fields</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="mlmc.random.correlated_field.Fields.names">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">names</span></code><a class="headerlink" href="#mlmc.random.correlated_field.Fields.names" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="mlmc.random.correlated_field.FourierSpatialCorrelatedField">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">mlmc.random.correlated_field.</span></code><code class="sig-name descname"><span class="pre">FourierSpatialCorrelatedField</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">corr_exp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gauss'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">corr_length</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aniso_correlation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mlmc/random/correlated_field.html#FourierSpatialCorrelatedField"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mlmc.random.correlated_field.FourierSpatialCorrelatedField" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#mlmc.random.correlated_field.RandomFieldBase" title="mlmc.random.correlated_field.RandomFieldBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">mlmc.random.correlated_field.RandomFieldBase</span></code></a></p>
<p>Generate spatial random fields</p>
<dl class="py method">
<dt id="mlmc.random.correlated_field.FourierSpatialCorrelatedField.exp">
<code class="sig-name descname"><span class="pre">exp</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mode_no</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mlmc/random/correlated_field.html#FourierSpatialCorrelatedField.exp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mlmc.random.correlated_field.FourierSpatialCorrelatedField.exp" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute an exponential spectrum
:param mode_no: int, Number of Fourier modes
:return: numpy.ndarray</p>
</dd></dl>

<dl class="py method">
<dt id="mlmc.random.correlated_field.FourierSpatialCorrelatedField.gau">
<code class="sig-name descname"><span class="pre">gau</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mode_no</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mlmc/random/correlated_field.html#FourierSpatialCorrelatedField.gau"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mlmc.random.correlated_field.FourierSpatialCorrelatedField.gau" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute a gaussian spectrum
:param mode_no: int, Number of Fourier modes
:return: numpy.ndarray</p>
</dd></dl>

<dl class="py method">
<dt id="mlmc.random.correlated_field.FourierSpatialCorrelatedField.get_normal_distr">
<code class="sig-name descname"><span class="pre">get_normal_distr</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mlmc/random/correlated_field.html#FourierSpatialCorrelatedField.get_normal_distr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mlmc.random.correlated_field.FourierSpatialCorrelatedField.get_normal_distr" title="Permalink to this definition">¶</a></dt>
<dd><p>Normal distributed arrays
:return: np.ndarray</p>
</dd></dl>

<dl class="py method">
<dt id="mlmc.random.correlated_field.FourierSpatialCorrelatedField.random_field">
<code class="sig-name descname"><span class="pre">random_field</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mlmc/random/correlated_field.html#FourierSpatialCorrelatedField.random_field"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mlmc.random.correlated_field.FourierSpatialCorrelatedField.random_field" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the random modes for the randomization method.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="mlmc.random.correlated_field.GSToolsSpatialCorrelatedField">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">mlmc.random.correlated_field.</span></code><code class="sig-name descname"><span class="pre">GSToolsSpatialCorrelatedField</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode_no</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mlmc/random/correlated_field.html#GSToolsSpatialCorrelatedField"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mlmc.random.correlated_field.GSToolsSpatialCorrelatedField" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#mlmc.random.correlated_field.RandomFieldBase" title="mlmc.random.correlated_field.RandomFieldBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">mlmc.random.correlated_field.RandomFieldBase</span></code></a></p>
<dl class="py method">
<dt id="mlmc.random.correlated_field.GSToolsSpatialCorrelatedField.change_srf">
<code class="sig-name descname"><span class="pre">change_srf</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seed</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mlmc/random/correlated_field.html#GSToolsSpatialCorrelatedField.change_srf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mlmc.random.correlated_field.GSToolsSpatialCorrelatedField.change_srf" title="Permalink to this definition">¶</a></dt>
<dd><p>Spatial random field with new seed
:param seed: int, random number generator seed
:return: None</p>
</dd></dl>

<dl class="py method">
<dt id="mlmc.random.correlated_field.GSToolsSpatialCorrelatedField.random_field">
<code class="sig-name descname"><span class="pre">random_field</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mlmc/random/correlated_field.html#GSToolsSpatialCorrelatedField.random_field"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mlmc.random.correlated_field.GSToolsSpatialCorrelatedField.random_field" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate the spatial random field
:return: field, np.ndarray</p>
</dd></dl>

<dl class="py method">
<dt id="mlmc.random.correlated_field.GSToolsSpatialCorrelatedField.sample">
<code class="sig-name descname"><span class="pre">sample</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mlmc/random/correlated_field.html#GSToolsSpatialCorrelatedField.sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mlmc.random.correlated_field.GSToolsSpatialCorrelatedField.sample" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Random field evaluated in points given by ‘set_points’</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="mlmc.random.correlated_field.RandomFieldBase">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">mlmc.random.correlated_field.</span></code><code class="sig-name descname"><span class="pre">RandomFieldBase</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">corr_exp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gauss'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">corr_length</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aniso_correlation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mlmc/random/correlated_field.html#RandomFieldBase"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mlmc.random.correlated_field.RandomFieldBase" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Base class for various methods for generating random fields.</p>
<p>Generating realizations of a spatially correlated random field F for a fixed set of points at X.
E[F(x)]       = mu(x)
Cov_ij = Cov[x_i,x_j]  = E[(F(x_i) - mu(x))(F(x_j) - mu(x))]</p>
<dl class="simple">
<dt>We assume stationary random field with covariance matrix Cov_ij:</dt><dd><p>Cov_i,j = c(x_i - x_j)</p>
</dd>
<dt>where c(X) is the “stationary covariance” function. We assume:</dt><dd><p>c(X) = sigma^2 exp( -<a href="#id1"><span class="problematic" id="id2">|</span></a>X^t K X|^(alpha/2) )</p>
</dd>
</dl>
<p>for spatially heterogeneous sigma(X) we consider particular non-stationary generalization:          Cov_i,i = sigma(x_i)*sigma(x_j) exp( -<a href="#id3"><span class="problematic" id="id4">|</span></a>X^t K X|^(alpha/2) ); X = x_i - x_j</p>
<dl class="simple">
<dt>where:</dt><dd><ul class="simple">
<li><p>sigma(X) is the standard deviance of the single uncorrelated value</p></li>
<li><p>K is a positive definite tensor with eigen vectors corresponding to
main directions and eigen values equal to (1/l_i)^2, where l_i is correlation
length in singel main direction.</p></li>
<li><p>alpha is =1 for “exponential” and =2 for “Gauss” correlation</p></li>
</ul>
</dd>
<dt>SVD decomposition:</dt><dd><p>Considering first m vectors, such that lam(m)/lam(0) &lt;0.1</p>
</dd>
</dl>
<p>Example:
<a href="#id5"><span class="problematic" id="id6">``</span></a><a href="#id7"><span class="problematic" id="id8">`</span></a></p>
<blockquote>
<div><p>field = SpatialCorrelatedField(corr_exp=’exp’, corr_length=1.5)
X, Y = np.mgrid[0:1:10j, 0:1:10j]
points = np.vstack([X.ravel(), Y.ravel()])
field.set_points(points)
sample = field.sample()</p>
</div></blockquote>
<p><a href="#id9"><span class="problematic" id="id10">``</span></a><a href="#id11"><span class="problematic" id="id12">`</span></a></p>
<dl class="py method">
<dt id="mlmc.random.correlated_field.RandomFieldBase.sample">
<code class="sig-name descname"><span class="pre">sample</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mlmc/random/correlated_field.html#RandomFieldBase.sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mlmc.random.correlated_field.RandomFieldBase.sample" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>uncorelated</strong> – Random samples from standard normal distribution.
Removed as the spectral method do not support it.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Random field evaluated in points given by ‘set_points’.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="mlmc.random.correlated_field.RandomFieldBase.set_points">
<code class="sig-name descname"><span class="pre">set_points</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">points</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mlmc/random/correlated_field.html#RandomFieldBase.set_points"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mlmc.random.correlated_field.RandomFieldBase.set_points" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>points</strong> – N x d array. Points X_i where the field will be evaluated. d is the dimension.</p></li>
<li><p><strong>mu</strong> – Scalar or N array. Mean value of uncorrelated field: E( F(X_i)).</p></li>
<li><p><strong>sigma</strong> – Scalar or N array. Standard deviance of uncorrelated field: sqrt( E ( F(X_i) - mu_i )^2 )</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="mlmc.random.correlated_field.SpatialCorrelatedField">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">mlmc.random.correlated_field.</span></code><code class="sig-name descname"><span class="pre">SpatialCorrelatedField</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">corr_exp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gauss'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">corr_length</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aniso_correlation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mlmc/random/correlated_field.html#SpatialCorrelatedField"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mlmc.random.correlated_field.SpatialCorrelatedField" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#mlmc.random.correlated_field.RandomFieldBase" title="mlmc.random.correlated_field.RandomFieldBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">mlmc.random.correlated_field.RandomFieldBase</span></code></a></p>
<dl class="py method">
<dt id="mlmc.random.correlated_field.SpatialCorrelatedField.cov_matrix">
<code class="sig-name descname"><span class="pre">cov_matrix</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mlmc/random/correlated_field.html#SpatialCorrelatedField.cov_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mlmc.random.correlated_field.SpatialCorrelatedField.cov_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Setup dense covariance matrix for given set of points.
:return: None.</p>
</dd></dl>

<dl class="py method">
<dt id="mlmc.random.correlated_field.SpatialCorrelatedField.svd_dcmp">
<code class="sig-name descname"><span class="pre">svd_dcmp</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">precision</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_terms_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(1,</span> <span class="pre">inf)</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mlmc/random/correlated_field.html#SpatialCorrelatedField.svd_dcmp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mlmc.random.correlated_field.SpatialCorrelatedField.svd_dcmp" title="Permalink to this definition">¶</a></dt>
<dd><p>Does decomposition of covariance matrix defined by set of points
:param precision: Desired accuracy of the KL approximation, smaller eigen values are dropped.
:param n_terms_range: (min, max) number of terms in KL expansion to use. The number of terms estimated from
given precision is snapped to the given interval.</p>
<dl class="simple">
<dt>truncated SVD:</dt><dd><p>cov_mat = U*diag(ev) * V,
_cov_l_factor = U[:,0:m]*sqrt(ev[0:m])</p>
</dd>
</dl>
<p>Note on number of terms:
According to: C. Schwab and R. A. Todor: KL Approximation of Random Fields by Generalized Fast Multiploe Method
the eigen values should decay as (Proposition 2.18):</p>
<blockquote>
<div><p>lambda_m ~ sigma^2 * ( 1/gamma ) <a href="#id13"><span class="problematic" id="id14">**</span></a>( m**(1/d) + alpha ) / Gamma(0.5 * m**(1/d) )</p>
</div></blockquote>
<p>where gamma = correlation length / domain diameter
ans alpha is the correlation exponent. Gamma is the gamma function.
… should be checked experimantaly and generalized for sigma(X)</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="mlmc.random.correlated_field.kozeny_carman">
<code class="sig-prename descclassname"><span class="pre">mlmc.random.correlated_field.</span></code><code class="sig-name descname"><span class="pre">kozeny_carman</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">porosity</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">factor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">viscosity</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mlmc/random/correlated_field.html#kozeny_carman"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mlmc.random.correlated_field.kozeny_carman" title="Permalink to this definition">¶</a></dt>
<dd><p>Kozeny-Carman law. Empirical relationship between porosity and conductivity.
:param porosity: Porosity value.
:param m: Power. Suitable values are 1 &lt; m &lt; 4
:param factor: [m^2]</p>
<blockquote>
<div><dl class="simple">
<dt>E.g. 1e-7 ,   m = 3.48;  juta fibers</dt><dd><p>2.2e-8 ,     1.46;  glass fibers
1.8e-13,     2.89;  erruptive material
1e-12        2.76;  erruptive material
1.8e-12      1.99;  basalt</p>
</dd>
</dl>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>viscosity</strong> – [Pa . s], water: 8.90e-4</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="mlmc.random.correlated_field.positive_to_range">
<code class="sig-prename descclassname"><span class="pre">mlmc.random.correlated_field.</span></code><code class="sig-name descname"><span class="pre">positive_to_range</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">exp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mlmc/random/correlated_field.html#positive_to_range"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mlmc.random.correlated_field.positive_to_range" title="Permalink to this definition">¶</a></dt>
<dd><p>Mapping a positive parameter ‘exp’ from the interval &lt;0, infty) to the interval &lt;a,b).
Suitable e.g. to generate meaningful porosity from a variable with lognormal distribution.
:param exp: A positive parameter. (LogNormal distribution.)
:param a, b: Range interval.</p>
</dd></dl>

</div>
<div class="section" id="mlmc-random-frac-geom-module">
<h2>mlmc.random.frac_geom module<a class="headerlink" href="#mlmc-random-frac-geom-module" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="mlmc-random-gstools-wrapper-module">
<h2>mlmc.random.gstools_wrapper module<a class="headerlink" href="#mlmc-random-gstools-wrapper-module" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-0">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-0" title="Permalink to this headline">¶</a></h2>
<p>Subpackage provides random field generation and <a class="reference external" href="https://geostat-framework.readthedocs.io/projects/gstools/en/stable/index.html">GSTools library</a> interface</p>
</div>
</div>


           </div>
           
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2022, Jan Březina, Martin Špetlík.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>